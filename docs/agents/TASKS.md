# TASKS (Single Source of Truth)

This file defines the platform work required to finish **agent-runner**.
Workflows like `quarkus-bootstrap-v1` are treated as demos/regression fixtures, not core deliverables.

Rules:
- Only implement items under **Now**.
- If new ideas come up, put them in **INBOX.md** and propose them for triage.
- Keep **Now** to 1–2 items max.
- No agent modifies platform code unless there is a corresponding item in TASKS.md → Now. 
---

## Now (Platform stability + completeness)

### 1) Define and enforce run/step state invariants
**Goal:** Make run + step state monotonic and consistent across API, worker, UI.

**DoD**
- Run status transitions are monotonic: QUEUED → RUNNING → (COMPLETED | FAILED | CANCELED)
- Step state never regresses (no completed → running)
- Events are strictly append-only and ordered by id
- Tests cover the invariants

**Notes**
- This is platform correctness; workflows are just inputs.

---

### 2) Standardize artifacts as first-class outputs (design first, implement minimal)
**Goal:** Every run can produce artifacts with metadata and retrieval.
We will *not* pick a final storage backend yet—start with a minimal abstraction.

**DoD**
- Artifact metadata model exists (id, run_id, name, kind, path or uri, created_at)
- API can list artifacts for a run (`GET /runs/{id}/artifacts`)
- UI can display artifacts list (even if download is v2)
- Tests cover artifact creation + listing

**Notes**
- Keep storage abstract: local filesystem ok for now.

---

## Next (Once Now is done)

- [ ] Add run cancellation (`POST /runs/{id}/cancel`) with cooperative worker checks
- [ ] Add LLM heartbeat events during long generations (great with SSE)
- [ ] Add workflow discovery endpoints (`GET /workflows`, `GET /workflows/{name}`)
- [ ] Add health endpoints (`/healthz`, `/readyz`) and basic deployment docs

---

## Later (Productization)

- [ ] Persistence strategy decision (SQLite/Postgres) + migrations
- [ ] Artifact download endpoint + durable artifact storage options
- [ ] Auth (optional)
- [ ] Provider abstraction growth (Ollama + future providers)

---

## Roadmap from Project Plan

This section outlines the planned features and improvements for the Agent Runner project, migrated from the former `PROJECT_PLAN.md`.

### Phase 1: Core Agent Capabilities (In Progress)

-   [ ] **Integrate with multiple LLM providers (Gemini, Claude, Ollama)**: Connect the agent to multiple LLM providers to enable flexible, real LLM-powered execution. *Note: The user has expressed a preference for using "Claude Coder" for development tasks on this project.*
-   [ ] **Implement File System Operations**: Allow agents to read and write files on the local file system.
-   [ ] **Basic Git Operations**: Implement basic Git operations, such as creating branches and committing changes.
-   [ ] **Artifact Management**: Implement a system for managing artifacts generated by agent runs.

### Phase 2: Advanced Agent Features

-   [ ] **Multi-Agent Coordination**: Implement a system for coordinating the execution of multiple agents.
-   [ ] **Web Browsing Capabilities**: Allow agents to browse the web to gather information.
-   [ ] **Long-Term Memory**: Implement a long-term memory solution for agents to retain information across runs.

### Phase 3: Workflow and Integration

-   [ ] **Forgejo Integration**: Integrate with Forgejo to automate Git-related tasks.
-   [ ] **Taiga Integration**: Integrate with Taiga for project management and issue tracking.
-   [ ] **Custom Workflows**: Allow users to define custom workflows for their agents.

### Phase 4: Production Readiness

-   [ ] **Authentication and Authorization**: Implement a robust authentication and authorization system.
-   [ ] **Scalability Improvements**: Improve the scalability of the system to handle a large number of concurrent runs.
-   [ ] **Monitoring and Alerting**: Implement a comprehensive monitoring and alerting system.
-   [ ] **Deployment Automation**: Automate the deployment of the Agent Runner to various environments.

